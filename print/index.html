<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 2.15.29"/><title data-react-helmet="true">A path to Recursion Schemes</title><link as="script" rel="preload" href="/component---gatsby-theme-mdx-deck-src-templates-deck-js-2c92febbeb618bbc1a78.js"/><link as="script" rel="preload" href="/commons-e097865efcb51aa1e34c.js"/><link as="script" rel="preload" href="/app-298faa2e9defffbeb4c3.js"/><link as="script" rel="preload" href="/webpack-runtime-cbe9baa0c15c82eadd81.js"/><link as="fetch" rel="preload" href="/page-data/print/page-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
        var mode = localStorage.getItem('theme-ui-color-mode');
        if (!mode) return
        document.body.classList.add('theme-ui-' + mode);
      } catch (e) {} })();</script><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><style data-emotion-css="13j5fvw">body{margin:0;}</style><style data-emotion-css="bdfrlc">.css-bdfrlc{width:100vw;height:100vh;}.css-bdfrlc *{box-sizing:border-box;}</style><div class="css-bdfrlc"><div style="outline:none;height:100%" tabindex="-1" role="group"><style data-emotion-css="k69u56">.css-k69u56{box-sizing:border-box;width:100%;height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;overflow:hidden;position:relative;color:var(--theme-ui-colors-text,#393A34);background-color:var(--theme-ui-colors-background,#f6f8fa);font-family:system-ui,sans-serif;font-size:20px;}@media screen and (min-width:40em){.css-k69u56{font-size:24px;}}@media screen and (min-width:52em){.css-k69u56{font-size:32px;}}@media screen and (min-width:64em){.css-k69u56{font-size:48px;}}</style><div class="css-k69u56"><style data-emotion-css="1djqpdg">.css-1djqpdg{font-family:inherit;line-height:1.125;font-weight:700;}</style><h2 class="css-1djqpdg">A path to Recursion Schemes</h2><p class="css-0">Grigory Pomadchin (<style data-emotion-css="wnzno2">.css-wnzno2{max-width:100%;height:auto;object-fit:cover;}</style><img src="https://github.com/favicon.ico" class="css-wnzno2"/> @pomadchin)</p><p class="css-0">(GIS) Open Source Software Engineer @ Azavea</p></div><div class="css-k69u56"><h5 class="css-1djqpdg">Azavea, a BCorporation</h5><img src="/img/azavea.png" class="css-wnzno2"/><img src="/img/geotrellis.png" class="css-wnzno2"/><br/><style data-emotion-css="1uk1gs8">.css-1uk1gs8{margin:0;}</style><ul class="css-1uk1gs8"><li class="css-0">Azavea applies GIS knowledges for positive impact </li><li class="css-0"><style data-emotion-css="6y53u">.css-6y53u{color:var(--theme-ui-colors-primary,#e3116c);}</style><a href="https://www.azavea.com/" class="css-6y53u">https://www.azavea.com/</a></li><li class="css-0"><a href="https://github.com/locationtech/geotrellis" class="css-6y53u">https://github.com/locationtech/geotrellis</a></li></ul></div><div class="css-k69u56"><h3 class="css-1djqpdg">DSL - is a computer <em class="css-0">language</em></h3><h3 class="css-1djqpdg">specialized to a particular application <em class="css-0">domain</em></h3></div><div class="css-k69u56"><h4 class="css-1djqpdg">A small exercise: defining our own DSL</h4></div><div class="css-k69u56"><div style="width:100vw;max-width:100%;height:100vh;display:flex;flex-direction:row;justify-content:center;align-items:center;font-size:0.8em;position:relative" class="cs-col-layout"><div style="flex:1;overflow:hidden;height:100%"><div style="display:flex;justify-content:center;align-items:center;height:100%"><ul class="css-1uk1gs8"><li class="css-0">Tile – chip of a scene (Array<!-- -->[Byte]<!-- -->)</li><li class="css-0">Extent – bounding box of a tile</li><li class="css-0">Raster – a tuple (Tile, Extent)</li><li class="css-0">Catalog of rasters - a list of rasters</li><li class="css-0"><strong class="css-0">Task</strong>: Query a catalog of rasters by extent intersection / coverage / etc</li></ul></div></div><div style="flex:1;overflow:hidden;height:100%"><div style="display:flex;justify-content:center;align-items:center;height:100%"><img src="/img/tilepyramid.png" class="css-wnzno2"/></div></div><style data-emotion-css="1xose5o">.css-1xose5o{position:absolute;top:0;width:100%;margin:0;padding:1em 0;text-align:center;background-color:#f6f8fa;color:#393A34;}</style><h4 class="cs-title css-1xose5o"><span>Step 1: Domain (GEOSPATIAL)</span></h4></div></div><div class="css-k69u56"><div style="width:100vw;max-width:100%;height:100vh;display:flex;flex-direction:row;justify-content:center;align-items:center;font-size:0.8em;position:relative" class="cs-col-layout"><div style="flex:1;overflow:hidden;height:100%"><div style="display:flex;justify-content:center;align-items:center;height:100%"><img src="/img/query-viz-mid.jpg" class="css-wnzno2"/></div></div><h4 class="cs-title css-1xose5o"><span>Step 1: Domain (GEOSPATIAL)</span></h4></div></div><div class="css-k69u56"><div style="width:100vw;max-width:100%;height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center" class="cs-layout"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="14tzmro">.css-14tzmro{color:#393A34;background-color:#f6f8fa;}.css-14tzmro .token-comment,.css-14tzmro .token-prolog,.css-14tzmro .token-doctype,.css-14tzmro .token-cdata{color:#999988;font-style:italic;}.css-14tzmro .token-namespace{opacity:0.7;}.css-14tzmro .token-string,.css-14tzmro .token-attr-value{color:#e3116c;}.css-14tzmro .token-punctuation,.css-14tzmro .token-operator{color:#393A34;}.css-14tzmro .token-entity,.css-14tzmro .token-url,.css-14tzmro .token-symbol,.css-14tzmro .token-number,.css-14tzmro .token-boolean,.css-14tzmro .token-variable,.css-14tzmro .token-constant,.css-14tzmro .token-property,.css-14tzmro .token-regex,.css-14tzmro .token-inserted{color:#36acaa;}.css-14tzmro .token-atrule,.css-14tzmro .token-keyword,.css-14tzmro .token-attr-name,.css-14tzmro .token-selector{color:#00a4db;}.css-14tzmro .token-function,.css-14tzmro .token-deleted,.css-14tzmro .token-tag{color:#d73a49;}.css-14tzmro .token-function-variable{color:#6f42c1;}.css-14tzmro .token-tag,.css-14tzmro .token-selector{color:#00009f;}</style><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="xdak34">.css-xdak34{color:#393A34;background-color:#f6f8fa;}</style><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-keyword">case</span><span class="token-plain"> </span><span class="token-keyword">class</span><span class="token-plain"> Extent</span><span class="token-punctuation">(</span><span class="token-plain">xmin</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-builtin">Double</span><span class="token-punctuation">,</span><span class="token-plain"> ymin</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-builtin">Double</span><span class="token-punctuation">,</span><span class="token-plain"> xmax</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-builtin">Double</span><span class="token-punctuation">,</span><span class="token-plain"> ymax</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-builtin">Double</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-keyword">type</span><span class="token-plain"> Tile </span><span class="token-operator">=</span><span class="token-plain"> Array</span><span class="token-punctuation">[</span><span class="token-builtin">Byte</span><span class="token-punctuation">]</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-keyword">type</span><span class="token-plain"> Raster </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-punctuation">(</span><span class="token-plain">Tile</span><span class="token-punctuation">,</span><span class="token-plain"> Extent</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-plain">​</span></div></div><div></div></code></pre><h4 class="cs-title css-1xose5o"><span>Step 2: Language</span></h4><style data-emotion-css="fs2d1k">.css-fs2d1k{position:absolute;bottom:0;width:calc(100% - 2em);box-sizing:border-box;margin:0.3em 1em;padding:0.5em;background:rgba(2,2,2,0.9);text-align:center;color:#d6deeb;background-color:rgba(10,10,10,0.9);}</style><p class="cs-subtitle css-fs2d1k"><span style="opacity:1">Helper types to understand the domain better</span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-keyword">case</span><span class="token-plain"> </span><span class="token-keyword">class</span><span class="token-plain"> Extent</span><span class="token-punctuation">(</span><span class="token-plain">xmin</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-builtin">Double</span><span class="token-punctuation">,</span><span class="token-plain"> ymin</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-builtin">Double</span><span class="token-punctuation">,</span><span class="token-plain"> xmax</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-builtin">Double</span><span class="token-punctuation">,</span><span class="token-plain"> ymax</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-builtin">Double</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-plain">​</span></div></div><div></div></code></pre><h4 class="cs-title css-1xose5o"><span>Step 2: Language</span></h4><p class="cs-subtitle css-fs2d1k"><span style="opacity:1">The DSL itself</span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-keyword">case</span><span class="token-plain"> </span><span class="token-keyword">class</span><span class="token-plain"> Extent</span><span class="token-punctuation">(</span><span class="token-plain">xmin</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-builtin">Double</span><span class="token-punctuation">,</span><span class="token-plain"> ymin</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-builtin">Double</span><span class="token-punctuation">,</span><span class="token-plain"> xmax</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-builtin">Double</span><span class="token-punctuation">,</span><span class="token-plain"> ymax</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-builtin">Double</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-plain">​</span></div></div><div></div></code></pre><h4 class="cs-title css-1xose5o" style="opacity:1"><span style="opacity:1">Step 2: Language</span></h4><p class="cs-subtitle css-fs2d1k" style="opacity:1"><span style="opacity:1">The usage example</span></p></div></div></div></div></div><div class="css-k69u56"><div style="width:100vw;max-width:100%;height:100vh;display:flex;flex-direction:row;justify-content:center;align-items:center;font-size:0.8em;position:relative" class="cs-col-layout"><div style="flex:1;overflow:hidden;height:100%"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-plain">Or</span><span class="token-punctuation">(</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">  And</span><span class="token-punctuation">(</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-plain">    And</span><span class="token-punctuation">(</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-plain">      Intersects</span><span class="token-punctuation">(</span><span class="token-plain">Extent</span><span class="token-punctuation">(</span><span class="token-operator">-</span><span class="token-number">116.9</span><span class="token-punctuation">,</span><span class="token-number">34.8</span><span class="token-punctuation">,</span><span class="token-operator">-</span><span class="token-number">113.8</span><span class="token-punctuation">,</span><span class="token-number">36.9</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span><span class="token-punctuation">,</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-plain">      Intersects</span><span class="token-punctuation">(</span><span class="token-plain">Extent</span><span class="token-punctuation">(</span><span class="token-operator">-</span><span class="token-number">115.5</span><span class="token-punctuation">,</span><span class="token-number">33.2</span><span class="token-punctuation">,</span><span class="token-operator">-</span><span class="token-number">111.7</span><span class="token-punctuation">,</span><span class="token-number">35.6</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-plain">    </span><span class="token-punctuation">)</span><span class="token-punctuation">,</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">    Intersects</span><span class="token-punctuation">(</span><span class="token-plain">Extent</span><span class="token-punctuation">(</span><span class="token-operator">-</span><span class="token-number">115.5</span><span class="token-punctuation">,</span><span class="token-number">39.2</span><span class="token-punctuation">,</span><span class="token-operator">-</span><span class="token-number">110.9</span><span class="token-punctuation">,</span><span class="token-number">42.5</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-plain">  </span><span class="token-punctuation">)</span><span class="token-punctuation">,</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-plain">  Intersects</span><span class="token-punctuation">(</span><span class="token-plain">Extent</span><span class="token-punctuation">(</span><span class="token-operator">-</span><span class="token-number">107.6</span><span class="token-punctuation">,</span><span class="token-number">38.5</span><span class="token-punctuation">,</span><span class="token-operator">-</span><span class="token-number">102.6</span><span class="token-punctuation">,</span><span class="token-number">42.1</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-9"><span class="token-punctuation">)</span></div></div><div></div></code></pre></div></div></div></div><div style="flex:1;overflow:hidden;height:100%"><div style="display:flex;justify-content:center;align-items:center;height:100%"><img src="/img/query-viz-mid.jpg" class="css-wnzno2"/></div></div><h4 class="cs-title css-1xose5o"><span>Step 2: Language</span></h4><p class="cs-subtitle css-fs2d1k" style="margin:0.3em 0"><span>The real query example</span></p></div></div><div class="css-k69u56"><div style="width:100vw;max-width:100%;height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center" class="cs-layout"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-keyword">def</span><span class="token-plain"> evalString</span><span class="token-punctuation">(</span><span class="token-plain">q</span><span class="token-operator">:</span><span class="token-plain"> Query</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-builtin">String</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-plain">  q </span><span class="token-keyword">match</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-plain">                       evalList</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">list</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">++</span><span class="token-plain"> evalList</span><span class="token-punctuation">(</span><span class="token-plain">q2</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">list</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-11"><span class="token-plain">    </span><span class="token-keyword">case</span><span class="token-plain"> And</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">,</span><span class="token-plain"> q2</span><span class="token-punctuation">)</span><span class="token-plain">   </span><span class="token-keyword">=&gt;</span><span class="token-plain"> s</span><span class="token-string">&quot;(${evalString(q1)} and ${evalString(q2)})&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-12"><span class="token-plain">    </span><span class="token-keyword">case</span><span class="token-plain"> Or</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">,</span><span class="token-plain"> q2</span><span class="token-punctuation">)</span><span class="token-plain">    </span><span class="token-keyword">=&gt;</span><span class="token-plain"> s</span><span class="token-string">&quot;(${evalString(q1)} or ${evalString(q2)})&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-13"><span class="token-plain">    </span><span class="token-keyword">case</span><span class="token-plain"> Intersects</span><span class="token-punctuation">(</span><span class="token-plain">e</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">=&gt;</span><span class="token-plain"> s</span><span class="token-string">&quot;(intersects $e)&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-14"><span class="token-plain">    </span><span class="token-keyword">case</span><span class="token-plain"> All</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">         </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span><span class="token-string">&quot;(all)&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-15"><span class="token-plain">    </span><span class="token-keyword">case</span><span class="token-plain"> Empty</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">       </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span><span class="token-string">&quot;(empty)&quot;</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-16"><span class="token-plain">  </span><span class="token-punctuation">}</span></div></div><div></div></code></pre><h4 class="cs-title css-1xose5o"><span>Step 3: Language Interpretation</span></h4></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-plain">                       evalList</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">list</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">++</span><span class="token-plain"> evalList</span><span class="token-punctuation">(</span><span class="token-plain">q2</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">list</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-16"><span class="token-plain">  </span><span class="token-punctuation">}</span></div></div><div></div></code></pre><h4 class="cs-title css-1xose5o" style="opacity:1"><span style="opacity:1">Step 3: Language Interpretation</span></h4></div></div></div></div></div><div class="css-k69u56"><div style="width:100vw;max-width:100%;height:100vh;display:flex;flex-direction:row;justify-content:center;align-items:center;font-size:0.8em;position:relative" class="cs-col-layout"><div style="flex:1;overflow:hidden;height:100%"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-keyword">d</span><span class="token-keyword">e</span><span class="token-keyword">f</span><span class="token-plain"> </span><span class="token-plain">e</span><span class="token-plain">v</span><span class="token-plain">a</span><span class="token-plain">l</span><span class="token-plain">S</span><span class="token-plain">t</span><span class="token-plain">r</span><span class="token-plain">i</span><span class="token-plain">n</span><span class="token-plain">g</span><span class="token-punctuation">(</span><span class="token-plain">q</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-builtin">S</span><span class="token-builtin">t</span><span class="token-builtin">r</span><span class="token-builtin">i</span><span class="token-builtin">n</span><span class="token-builtin">g</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">  q </span><span class="token-keyword">match</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-keyword" style="opacity:1">c</span><span class="token-keyword" style="opacity:1">a</span><span class="token-keyword" style="opacity:1">s</span><span class="token-keyword" style="opacity:1">e</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">A</span><span class="token-plain" style="opacity:1">n</span><span class="token-plain" style="opacity:1">d</span><span class="token-punctuation" style="opacity:1">(</span><span class="token-plain" style="opacity:1">q</span><span class="token-plain" style="opacity:1">1</span><span class="token-punctuation" style="opacity:1">,</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">q</span><span class="token-plain" style="opacity:1">2</span><span class="token-punctuation" style="opacity:1">)</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-keyword" style="opacity:1">=</span><span class="token-keyword" style="opacity:1">&gt;</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">s</span><span class="token-string" style="opacity:1">&quot;</span><span class="token-string" style="opacity:1">(</span><span class="token-string" style="opacity:1">$</span><span class="token-string" style="opacity:1">{</span><span class="token-string" style="opacity:1">e</span><span class="token-string" style="opacity:1">v</span><span class="token-string" style="opacity:1">a</span><span class="token-string" style="opacity:1">l</span><span class="token-string" style="opacity:1">S</span><span class="token-string" style="opacity:1">t</span><span class="token-string" style="opacity:1">r</span><span class="token-string" style="opacity:1">i</span><span class="token-string" style="opacity:1">n</span><span class="token-string" style="opacity:1">g</span><span class="token-string" style="opacity:1">(</span><span class="token-string" style="opacity:1">q</span><span class="token-string" style="opacity:1">1</span><span class="token-string" style="opacity:1">)</span><span class="token-string" style="opacity:1">}</span><span class="token-string" style="opacity:1"> </span><span class="token-string" style="opacity:1">a</span><span class="token-string" style="opacity:1">n</span><span class="token-string" style="opacity:1">d</span><span class="token-string" style="opacity:1"> </span><span class="token-string" style="opacity:1">$</span><span class="token-string" style="opacity:1">{</span><span class="token-string" style="opacity:1">e</span><span class="token-string" style="opacity:1">v</span><span class="token-string" style="opacity:1">a</span><span class="token-string" style="opacity:1">l</span><span class="token-string" style="opacity:1">S</span><span class="token-string" style="opacity:1">t</span><span class="token-string" style="opacity:1">r</span><span class="token-string" style="opacity:1">i</span><span class="token-string" style="opacity:1">n</span><span class="token-string" style="opacity:1">g</span><span class="token-string" style="opacity:1">(</span><span class="token-string" style="opacity:1">q</span><span class="token-string" style="opacity:1">2</span><span class="token-string" style="opacity:1">)</span><span class="token-string" style="opacity:1">}</span><span class="token-string" style="opacity:1">)</span><span class="token-string" style="opacity:1">&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-keyword">c</span><span class="token-keyword">a</span><span class="token-keyword">s</span><span class="token-keyword">e</span><span class="token-plain"> </span><span class="token-plain">O</span><span class="token-plain">r</span><span class="token-punctuation">(</span><span class="token-plain">q</span><span class="token-plain">1</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-plain">q</span><span class="token-plain">2</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-keyword">=</span><span class="token-keyword">&gt;</span><span class="token-plain"> </span><span class="token-plain">s</span><span class="token-string">&quot;</span><span class="token-string">(</span><span class="token-string">$</span><span class="token-string">{</span><span class="token-string">e</span><span class="token-string">v</span><span class="token-string">a</span><span class="token-string">l</span><span class="token-string">S</span><span class="token-string">t</span><span class="token-string">r</span><span class="token-string">i</span><span class="token-string">n</span><span class="token-string">g</span><span class="token-string">(</span><span class="token-string">q</span><span class="token-string">1</span><span class="token-string">)</span><span class="token-string">}</span><span class="token-string"> </span><span class="token-string">o</span><span class="token-string">r</span><span class="token-string"> </span><span class="token-string">$</span><span class="token-string">{</span><span class="token-string">e</span><span class="token-string">v</span><span class="token-string">a</span><span class="token-string">l</span><span class="token-string">S</span><span class="token-string">t</span><span class="token-string">r</span><span class="token-string">i</span><span class="token-string">n</span><span class="token-string">g</span><span class="token-string">(</span><span class="token-string">q</span><span class="token-string">2</span><span class="token-string">)</span><span class="token-string">}</span><span class="token-string">)</span><span class="token-string">&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-plain">    </span><span class="token-keyword">case</span><span class="token-plain"> Intersects</span><span class="token-punctuation">(</span><span class="token-plain">e</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">=&gt;</span><span class="token-plain"> s</span><span class="token-string">&quot;(intersects $e)&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-plain">    </span><span class="token-keyword">case</span><span class="token-plain"> All</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">         </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span><span class="token-string">&quot;(all)&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">    </span><span class="token-keyword">case</span><span class="token-plain"> Empty</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">       </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span><span class="token-string">&quot;(empty)&quot;</span></div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-plain">  </span><span class="token-punctuation">}</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-keyword" style="opacity:1">c</span><span class="token-keyword" style="opacity:1">a</span><span class="token-keyword" style="opacity:1">s</span><span class="token-keyword" style="opacity:1">e</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">A</span><span class="token-plain" style="opacity:1">n</span><span class="token-plain" style="opacity:1">d</span><span class="token-punctuation" style="opacity:1">(</span><span class="token-plain" style="opacity:1">q</span><span class="token-plain" style="opacity:0.3">1</span><span class="token-punctuation" style="opacity:0.3">,</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">q</span><span class="token-plain" style="opacity:0.3">2</span><span class="token-punctuation" style="opacity:0.3">)</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-keyword" style="opacity:0.3">=</span><span class="token-keyword" style="opacity:0.3">&gt;</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">s</span><span class="token-string" style="opacity:0.3">&quot;</span><span class="token-string" style="opacity:0.3">(</span><span class="token-string" style="opacity:0.3">$</span><span class="token-string" style="opacity:0.3">{</span><span class="token-string" style="opacity:0.3">e</span><span class="token-string" style="opacity:0.3">v</span><span class="token-string" style="opacity:0.3">a</span><span class="token-string" style="opacity:0.3">l</span><span class="token-string" style="opacity:0.3">S</span><span class="token-string" style="opacity:0.3">t</span><span class="token-string" style="opacity:0.3">r</span><span class="token-string" style="opacity:0.3">i</span><span class="token-string" style="opacity:0.3">n</span><span class="token-string" style="opacity:0.3">g</span><span class="token-string" style="opacity:0.3">(</span><span class="token-string" style="opacity:0.3">q</span><span class="token-string" style="opacity:0.3">1</span><span class="token-string" style="opacity:0.3">)</span><span class="token-string" style="opacity:0.3">}</span><span class="token-string" style="opacity:0.3"> </span><span class="token-string" style="opacity:0.3">a</span><span class="token-string" style="opacity:0.3">n</span><span class="token-string" style="opacity:0.3">d</span><span class="token-string" style="opacity:0.3"> </span><span class="token-string" style="opacity:0.3">$</span><span class="token-string" style="opacity:0.3">{</span><span class="token-string" style="opacity:0.3">e</span><span class="token-string" style="opacity:0.3">v</span><span class="token-string" style="opacity:0.3">a</span><span class="token-string" style="opacity:0.3">l</span><span class="token-string" style="opacity:0.3">S</span><span class="token-string" style="opacity:0.3">t</span><span class="token-string" style="opacity:0.3">r</span><span class="token-string" style="opacity:0.3">i</span><span class="token-string" style="opacity:0.3">n</span><span class="token-string" style="opacity:0.3">g</span><span class="token-string" style="opacity:0.3">(</span><span class="token-string" style="opacity:0.3">q</span><span class="token-string" style="opacity:0.3">2</span><span class="token-string" style="opacity:0.3">)</span><span class="token-string" style="opacity:0.3">}</span><span class="token-string" style="opacity:0.3">)</span><span class="token-string" style="opacity:0.3">&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-plain">  </span><span class="token-punctuation">}</span></div></div><div></div></code></pre></div></div></div></div><div style="flex:1;overflow:hidden;height:100%"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="of03ro">.css-of03ro{color:#d6deeb;background-color:#011627;}.css-of03ro .token-comment,.css-of03ro .token-prolog,.css-of03ro .token-doctype,.css-of03ro .token-cdata{color:#999988;font-style:italic;}.css-of03ro .token-namespace{opacity:0.7;color:rgb(178,204,214);}.css-of03ro .token-string,.css-of03ro .token-attr-value{color:#e3116c;}.css-of03ro .token-punctuation,.css-of03ro .token-operator{color:#393A34;}.css-of03ro .token-entity,.css-of03ro .token-url,.css-of03ro .token-symbol,.css-of03ro .token-number,.css-of03ro .token-boolean,.css-of03ro .token-variable,.css-of03ro .token-constant,.css-of03ro .token-property,.css-of03ro .token-regex,.css-of03ro .token-inserted{color:#36acaa;}.css-of03ro .token-atrule,.css-of03ro .token-keyword,.css-of03ro .token-attr-name,.css-of03ro .token-selector{color:#00a4db;}.css-of03ro .token-function,.css-of03ro .token-deleted,.css-of03ro .token-tag{color:#d73a49;}.css-of03ro .token-function-variable{color:#6f42c1;}.css-of03ro .token-tag,.css-of03ro .token-selector{color:#00009f;}.css-of03ro .token-changed{color:rgb(162,191,252);font-style:italic;}.css-of03ro .token-deleted{color:rgba(239,83,80,0.56);font-style:italic;}.css-of03ro .token-inserted,.css-of03ro .token-attr-name{color:rgb(173,219,103);font-style:italic;}.css-of03ro .token-comment{color:rgb(99,119,119);font-style:italic;}.css-of03ro .token-string,.css-of03ro .token-url{color:rgb(173,219,103);}.css-of03ro .token-variable{color:rgb(214,222,235);}.css-of03ro .token-number{color:rgb(247,140,108);}.css-of03ro .token-builtin,.css-of03ro .token-char,.css-of03ro .token-constant,.css-of03ro .token-function{color:rgb(130,170,255);}.css-of03ro .token-punctuation{color:rgb(199,146,234);}.css-of03ro .token-selector,.css-of03ro .token-doctype{color:rgb(199,146,234);font-style:italic;}.css-of03ro .token-class-name{color:rgb(255,203,139);}.css-of03ro .token-tag,.css-of03ro .token-operator,.css-of03ro .token-keyword{color:rgb(127,219,202);}.css-of03ro .token-boolean{color:rgb(255,88,116);}.css-of03ro .token-property{color:rgb(128,203,196);}</style><pre class="cs-content css-of03ro" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="1mpkuhi">.css-1mpkuhi{color:#d6deeb;background-color:#011627;}</style><code class="cs-scaled-content css-1mpkuhi" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-keyword">d</span><span class="token-keyword">e</span><span class="token-keyword">f</span><span class="token-plain"> </span><span class="token-plain">e</span><span class="token-plain">v</span><span class="token-plain">a</span><span class="token-plain">l</span><span class="token-plain">L</span><span class="token-plain">i</span><span class="token-plain">s</span><span class="token-plain">t</span><span class="token-punctuation">(</span><span class="token-plain">q</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">L</span><span class="token-plain">i</span><span class="token-plain">s</span><span class="token-plain">t</span><span class="token-punctuation">[</span><span class="token-plain">R</span><span class="token-plain">a</span><span class="token-plain">s</span><span class="token-plain">t</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-keyword">=</span><span class="token-keyword">&gt;</span><span class="token-plain"> </span><span class="token-plain">L</span><span class="token-plain">i</span><span class="token-plain">s</span><span class="token-plain">t</span><span class="token-punctuation">[</span><span class="token-plain">R</span><span class="token-plain">a</span><span class="token-plain">s</span><span class="token-plain">t</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">  q </span><span class="token-keyword">match</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-plain">    </span><span class="token-keyword">case</span><span class="token-plain"> And</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">,</span><span class="token-plain"> q2</span><span class="token-punctuation">)</span><span class="token-plain">   </span><span class="token-keyword">=&gt;</span><span class="token-plain"> list </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-keyword">v</span><span class="token-keyword">a</span><span class="token-keyword">l</span><span class="token-plain"> </span><span class="token-plain">l</span><span class="token-plain">e</span><span class="token-plain">f</span><span class="token-plain">t</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-plain">e</span><span class="token-plain">v</span><span class="token-plain">a</span><span class="token-plain">l</span><span class="token-plain">L</span><span class="token-plain">i</span><span class="token-plain">s</span><span class="token-plain">t</span><span class="token-punctuation">(</span><span class="token-plain">q</span><span class="token-plain">1</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">l</span><span class="token-plain">i</span><span class="token-plain">s</span><span class="token-plain">t</span><span class="token-punctuation">)</span><span class="token-plain"> </span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain">e</span><span class="token-plain">v</span><span class="token-plain">a</span><span class="token-plain">l</span><span class="token-plain">L</span><span class="token-plain">i</span><span class="token-plain">s</span><span class="token-plain">t</span><span class="token-punctuation">(</span><span class="token-plain">q</span><span class="token-plain">2</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">l</span><span class="token-plain">e</span><span class="token-plain">f</span><span class="token-plain">t</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-plain">    </span><span class="token-keyword">case</span><span class="token-plain"> Or</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">,</span><span class="token-plain"> q2</span><span class="token-punctuation">)</span><span class="token-plain">    </span><span class="token-keyword">=&gt;</span><span class="token-plain"> list </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">e</span><span class="token-plain" style="opacity:1">v</span><span class="token-plain" style="opacity:1">a</span><span class="token-plain" style="opacity:1">l</span><span class="token-plain" style="opacity:1">L</span><span class="token-plain" style="opacity:1">i</span><span class="token-plain" style="opacity:1">s</span><span class="token-plain" style="opacity:1">t</span><span class="token-punctuation" style="opacity:1">(</span><span class="token-plain" style="opacity:1">q</span><span class="token-plain" style="opacity:1">1</span><span class="token-punctuation" style="opacity:1">)</span><span class="token-punctuation" style="opacity:1">(</span><span class="token-plain" style="opacity:1">l</span><span class="token-plain" style="opacity:1">i</span><span class="token-plain" style="opacity:1">s</span><span class="token-plain" style="opacity:1">t</span><span class="token-punctuation" style="opacity:1">)</span><span class="token-plain" style="opacity:1"> </span><span class="token-operator" style="opacity:1">+</span><span class="token-operator" style="opacity:1">+</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">e</span><span class="token-plain" style="opacity:1">v</span><span class="token-plain" style="opacity:1">a</span><span class="token-plain" style="opacity:1">l</span><span class="token-plain" style="opacity:1">L</span><span class="token-plain" style="opacity:1">i</span><span class="token-plain" style="opacity:1">s</span><span class="token-plain" style="opacity:1">t</span><span class="token-punctuation" style="opacity:1">(</span><span class="token-plain" style="opacity:1">q</span><span class="token-plain" style="opacity:1">2</span><span class="token-punctuation" style="opacity:1">)</span><span class="token-punctuation" style="opacity:1">(</span><span class="token-plain" style="opacity:1">l</span><span class="token-plain" style="opacity:1">i</span><span class="token-plain" style="opacity:1">s</span><span class="token-plain" style="opacity:1">t</span><span class="token-punctuation" style="opacity:1">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-plain">    </span><span class="token-keyword">case</span><span class="token-plain"> Intersects</span><span class="token-punctuation">(</span><span class="token-plain">e</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">=&gt;</span><span class="token-plain"> _</span><span class="token-punctuation">.</span><span class="token-plain">filter</span><span class="token-punctuation">(</span><span class="token-plain">_</span><span class="token-punctuation">.</span><span class="token-plain">extent</span><span class="token-punctuation">.</span><span class="token-plain">intersects</span><span class="token-punctuation">(</span><span class="token-plain">e</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-plain">    </span><span class="token-keyword">case</span><span class="token-plain"> All</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">         </span><span class="token-keyword">=&gt;</span><span class="token-plain"> identity</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-9"><span class="token-plain">    </span><span class="token-keyword">case</span><span class="token-plain"> Empty</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">       </span><span class="token-keyword">=&gt;</span><span class="token-plain"> _ </span><span class="token-keyword">=&gt;</span><span class="token-plain"> Nil</span></div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-10"><span class="token-plain">  </span><span class="token-punctuation">}</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-of03ro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-1mpkuhi" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">e</span><span class="token-plain" style="opacity:0.3">v</span><span class="token-plain" style="opacity:0.3">a</span><span class="token-plain" style="opacity:0.3">l</span><span class="token-plain" style="opacity:0.3">L</span><span class="token-plain" style="opacity:0.3">i</span><span class="token-plain" style="opacity:0.3">s</span><span class="token-plain" style="opacity:0.3">t</span><span class="token-punctuation" style="opacity:0.3">(</span><span class="token-plain" style="opacity:0.3">q</span><span class="token-plain" style="opacity:0.3">1</span><span class="token-punctuation" style="opacity:0.3">)</span><span class="token-punctuation" style="opacity:0.3">(</span><span class="token-plain" style="opacity:0.3">l</span><span class="token-plain" style="opacity:0.3">i</span><span class="token-plain" style="opacity:0.3">s</span><span class="token-plain" style="opacity:0.3">t</span><span class="token-punctuation" style="opacity:0.3">)</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-operator" style="opacity:0.3">+</span><span class="token-operator" style="opacity:0.3">+</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">e</span><span class="token-plain" style="opacity:0.3">v</span><span class="token-plain" style="opacity:0.3">a</span><span class="token-plain" style="opacity:0.3">l</span><span class="token-plain" style="opacity:0.3">L</span><span class="token-plain" style="opacity:0.3">i</span><span class="token-plain" style="opacity:0.3">s</span><span class="token-plain" style="opacity:0.3">t</span><span class="token-punctuation" style="opacity:0.3">(</span><span class="token-plain" style="opacity:0.3">q</span><span class="token-plain" style="opacity:0.3">2</span><span class="token-punctuation" style="opacity:0.3">)</span><span class="token-punctuation" style="opacity:0.3">(</span><span class="token-plain" style="opacity:0.3">l</span><span class="token-plain" style="opacity:0.3">i</span><span class="token-plain" style="opacity:0.3">s</span><span class="token-plain" style="opacity:0.3">t</span><span class="token-punctuation" style="opacity:0.3">)</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-10"><span class="token-plain">  </span><span class="token-punctuation">}</span></div></div><div></div></code></pre></div></div></div></div></div></div><div class="css-k69u56"><div style="width:100vw;max-width:100%;height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center" class="cs-layout"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-keyword">d</span><span class="token-keyword">e</span><span class="token-keyword">f</span><span class="token-plain"> </span><span class="token-plain">f</span><span class="token-plain">o</span><span class="token-plain">l</span><span class="token-plain">d</span><span class="token-plain">R</span><span class="token-plain">i</span><span class="token-plain">g</span><span class="token-plain">h</span><span class="token-plain">t</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain"> </span><span class="token-keyword">=</span><span class="token-keyword">&gt;</span><span class="token-plain"> </span><span class="token-plain">A</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">q</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">A</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-keyword">def</span><span class="token-plain"> eval</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-operator">:</span><span class="token-plain"> Query </span><span class="token-keyword">=&gt;</span><span class="token-plain"> A</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">q</span><span class="token-operator">:</span><span class="token-plain"> Query</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> A </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-comment" style="opacity:1">// where </span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-keyword">val</span><span class="token-plain"> f </span><span class="token-operator">=</span><span class="token-plain"> q </span><span class="token-keyword">match</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> And</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">,</span><span class="token-plain"> q2</span><span class="token-punctuation">)</span><span class="token-plain">   </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> Or</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">,</span><span class="token-plain"> q2</span><span class="token-punctuation">)</span><span class="token-plain">    </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> Intersects</span><span class="token-punctuation">(</span><span class="token-plain">e</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> All</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">         </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-9"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> Empty</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">       </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-10"><span class="token-punctuation">}</span></div></div><div></div></code></pre><h4 class="cs-title css-1xose5o"><span>Generalization</span></h4></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-keyword">d</span><span class="token-keyword">e</span><span class="token-keyword">f</span><span class="token-plain"> </span><span class="token-plain">f</span><span class="token-plain">o</span><span class="token-plain">l</span><span class="token-plain">d</span><span class="token-plain">R</span><span class="token-plain">i</span><span class="token-plain">g</span><span class="token-plain">h</span><span class="token-plain">t</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain"> </span><span class="token-keyword">=</span><span class="token-keyword">&gt;</span><span class="token-plain"> </span><span class="token-plain">A</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">q</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">A</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-comment" style="opacity:0.3">// where </span></div></div><div></div></code></pre><h4 class="cs-title css-1xose5o" style="opacity:1"><span style="opacity:1">Generalization</span></h4></div></div></div></div></div><div class="css-k69u56"><h6 class="css-1djqpdg">Generalized functions to traverse through nested structures are called <em class="css-0">recursion schemes</em>.</h6></div><div class="css-k69u56"><div style="width:100vw;max-width:100%;height:100vh;display:flex;flex-direction:row;justify-content:center;align-items:center;font-size:0.8em;position:relative" class="cs-col-layout"><div style="flex:1;overflow:hidden;height:100%"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-keyword">sealed</span><span class="token-plain"> </span><span class="token-keyword">trait</span><span class="token-plain"> Query</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-keyword">case</span><span class="token-plain"> </span><span class="token-keyword">class</span><span class="token-plain"> And</span><span class="token-punctuation">(</span><span class="token-plain">l</span><span class="token-operator">:</span><span class="token-plain"> Query</span><span class="token-punctuation">,</span><span class="token-plain"> r</span><span class="token-operator">:</span><span class="token-plain"> Query</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">extends</span><span class="token-plain"> Query</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-keyword">case</span><span class="token-plain"> </span><span class="token-keyword">class</span><span class="token-plain"> Or</span><span class="token-punctuation">(</span><span class="token-plain">l</span><span class="token-operator">:</span><span class="token-plain"> Query</span><span class="token-punctuation">,</span><span class="token-plain"> r</span><span class="token-operator">:</span><span class="token-plain"> Query</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">extends</span><span class="token-plain"> Query</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-keyword">case</span><span class="token-plain"> </span><span class="token-keyword">class</span><span class="token-plain"> Intersects</span><span class="token-punctuation">(</span><span class="token-plain">extent</span><span class="token-operator">:</span><span class="token-plain"> Extent</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">extends</span><span class="token-plain"> Query</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-keyword">case</span><span class="token-plain"> </span><span class="token-keyword">class</span><span class="token-plain"> All</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">extends</span><span class="token-plain"> Query</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-keyword">case</span><span class="token-plain"> </span><span class="token-keyword">class</span><span class="token-plain"> Empty</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">extends</span><span class="token-plain"> Query</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">​</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-keyword">case</span><span class="token-plain"> </span><span class="token-keyword">class</span><span class="token-plain"> Intersects</span><span class="token-punctuation">(</span><span class="token-plain">extent</span><span class="token-operator">:</span><span class="token-plain"> Extent</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">extends</span><span class="token-plain"> Query</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">​</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-keyword">case</span><span class="token-plain"> </span><span class="token-keyword">class</span><span class="token-plain"> Intersects</span><span class="token-punctuation">(</span><span class="token-plain">extent</span><span class="token-operator">:</span><span class="token-plain"> Extent</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">extends</span><span class="token-plain"> Query</span></div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">​</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-keyword">case</span><span class="token-plain"> </span><span class="token-keyword">class</span><span class="token-plain"> Intersects</span><span class="token-punctuation">(</span><span class="token-plain">extent</span><span class="token-operator">:</span><span class="token-plain"> Extent</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">extends</span><span class="token-plain"> Query</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">​</span></div></div><div></div></code></pre></div></div></div></div><div style="flex:1;overflow:hidden;height:100%"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-of03ro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-1mpkuhi" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-keyword">s</span><span class="token-keyword">e</span><span class="token-keyword">a</span><span class="token-keyword">l</span><span class="token-keyword">e</span><span class="token-keyword">d</span><span class="token-plain"> </span><span class="token-keyword">t</span><span class="token-keyword">r</span><span class="token-keyword">a</span><span class="token-keyword">i</span><span class="token-keyword">t</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-keyword">c</span><span class="token-keyword">a</span><span class="token-keyword">s</span><span class="token-keyword">e</span><span class="token-plain"> </span><span class="token-keyword">c</span><span class="token-keyword">l</span><span class="token-keyword">a</span><span class="token-keyword">s</span><span class="token-keyword">s</span><span class="token-plain"> </span><span class="token-plain">A</span><span class="token-plain">n</span><span class="token-plain">d</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">l</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">A</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-plain">r</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">A</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">e</span><span class="token-keyword">x</span><span class="token-keyword">t</span><span class="token-keyword">e</span><span class="token-keyword">n</span><span class="token-keyword">d</span><span class="token-keyword">s</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-keyword">c</span><span class="token-keyword">a</span><span class="token-keyword">s</span><span class="token-keyword">e</span><span class="token-plain"> </span><span class="token-keyword">c</span><span class="token-keyword">l</span><span class="token-keyword">a</span><span class="token-keyword">s</span><span class="token-keyword">s</span><span class="token-plain"> </span><span class="token-plain">O</span><span class="token-plain">r</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">l</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">A</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-plain">r</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">A</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">e</span><span class="token-keyword">x</span><span class="token-keyword">t</span><span class="token-keyword">e</span><span class="token-keyword">n</span><span class="token-keyword">d</span><span class="token-keyword">s</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-keyword" style="opacity:1">c</span><span class="token-keyword" style="opacity:1">a</span><span class="token-keyword" style="opacity:1">s</span><span class="token-keyword" style="opacity:1">e</span><span class="token-plain" style="opacity:1"> </span><span class="token-keyword" style="opacity:1">c</span><span class="token-keyword" style="opacity:1">l</span><span class="token-keyword" style="opacity:1">a</span><span class="token-keyword" style="opacity:1">s</span><span class="token-keyword" style="opacity:1">s</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">I</span><span class="token-plain" style="opacity:1">n</span><span class="token-plain" style="opacity:1">t</span><span class="token-plain" style="opacity:1">e</span><span class="token-plain" style="opacity:1">r</span><span class="token-plain" style="opacity:1">s</span><span class="token-plain" style="opacity:1">e</span><span class="token-plain" style="opacity:1">c</span><span class="token-plain" style="opacity:1">t</span><span class="token-plain" style="opacity:1">s</span><span class="token-punctuation" style="opacity:1">[</span><span class="token-plain" style="opacity:1">A</span><span class="token-punctuation" style="opacity:1">]</span><span class="token-punctuation" style="opacity:1">(</span><span class="token-plain" style="opacity:1">e</span><span class="token-plain" style="opacity:1">x</span><span class="token-plain" style="opacity:1">t</span><span class="token-plain" style="opacity:1">e</span><span class="token-plain" style="opacity:1">n</span><span class="token-plain" style="opacity:1">t</span><span class="token-operator" style="opacity:1">:</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">E</span><span class="token-plain" style="opacity:1">x</span><span class="token-plain" style="opacity:1">t</span><span class="token-plain" style="opacity:1">e</span><span class="token-plain" style="opacity:1">n</span><span class="token-plain" style="opacity:1">t</span><span class="token-punctuation" style="opacity:1">)</span><span class="token-plain" style="opacity:1"> </span><span class="token-keyword" style="opacity:1">e</span><span class="token-keyword" style="opacity:1">x</span><span class="token-keyword" style="opacity:1">t</span><span class="token-keyword" style="opacity:1">e</span><span class="token-keyword" style="opacity:1">n</span><span class="token-keyword" style="opacity:1">d</span><span class="token-keyword" style="opacity:1">s</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">Q</span><span class="token-plain" style="opacity:1">u</span><span class="token-plain" style="opacity:1">e</span><span class="token-plain" style="opacity:1">r</span><span class="token-plain" style="opacity:1">y</span><span class="token-plain" style="opacity:1">F</span><span class="token-punctuation" style="opacity:1">[</span><span class="token-plain" style="opacity:1">A</span><span class="token-punctuation" style="opacity:1">]</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-keyword">c</span><span class="token-keyword">a</span><span class="token-keyword">s</span><span class="token-keyword">e</span><span class="token-plain"> </span><span class="token-keyword">c</span><span class="token-keyword">l</span><span class="token-keyword">a</span><span class="token-keyword">s</span><span class="token-keyword">s</span><span class="token-plain"> </span><span class="token-plain">A</span><span class="token-plain">l</span><span class="token-plain">l</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">e</span><span class="token-keyword">x</span><span class="token-keyword">t</span><span class="token-keyword">e</span><span class="token-keyword">n</span><span class="token-keyword">d</span><span class="token-keyword">s</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-keyword">c</span><span class="token-keyword">a</span><span class="token-keyword">s</span><span class="token-keyword">e</span><span class="token-plain"> </span><span class="token-keyword">c</span><span class="token-keyword">l</span><span class="token-keyword">a</span><span class="token-keyword">s</span><span class="token-keyword">s</span><span class="token-plain"> </span><span class="token-plain">E</span><span class="token-plain">m</span><span class="token-plain">p</span><span class="token-plain">t</span><span class="token-plain">y</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">e</span><span class="token-keyword">x</span><span class="token-keyword">t</span><span class="token-keyword">e</span><span class="token-keyword">n</span><span class="token-keyword">d</span><span class="token-keyword">s</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain" style="opacity:0">​</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-of03ro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-1mpkuhi" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-keyword" style="opacity:0.3">c</span><span class="token-keyword" style="opacity:0.3">a</span><span class="token-keyword" style="opacity:0.3">s</span><span class="token-keyword" style="opacity:0.3">e</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-keyword" style="opacity:0.3">c</span><span class="token-keyword" style="opacity:0.3">l</span><span class="token-keyword" style="opacity:0.3">a</span><span class="token-keyword" style="opacity:0.3">s</span><span class="token-keyword" style="opacity:0.3">s</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">I</span><span class="token-plain" style="opacity:0.3">n</span><span class="token-plain" style="opacity:0.3">t</span><span class="token-plain" style="opacity:0.3">e</span><span class="token-plain" style="opacity:0.3">r</span><span class="token-plain" style="opacity:0.3">s</span><span class="token-plain" style="opacity:0.3">e</span><span class="token-plain" style="opacity:0.3">c</span><span class="token-plain" style="opacity:0.3">t</span><span class="token-plain" style="opacity:1">s</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">A</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">(</span><span class="token-plain" style="opacity:0.3">e</span><span class="token-plain" style="opacity:0.3">x</span><span class="token-plain" style="opacity:0.3">t</span><span class="token-plain" style="opacity:0.3">e</span><span class="token-plain" style="opacity:0.3">n</span><span class="token-plain" style="opacity:0.3">t</span><span class="token-operator" style="opacity:0.3">:</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">E</span><span class="token-plain" style="opacity:0.3">x</span><span class="token-plain" style="opacity:0.3">t</span><span class="token-plain" style="opacity:0.3">e</span><span class="token-plain" style="opacity:0.3">n</span><span class="token-plain" style="opacity:0.3">t</span><span class="token-punctuation" style="opacity:0.3">)</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-keyword" style="opacity:0.3">e</span><span class="token-keyword" style="opacity:0.3">x</span><span class="token-keyword" style="opacity:0.3">t</span><span class="token-keyword" style="opacity:0.3">e</span><span class="token-keyword" style="opacity:0.3">n</span><span class="token-keyword" style="opacity:0.3">d</span><span class="token-keyword" style="opacity:0.3">s</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">Q</span><span class="token-plain" style="opacity:0.3">u</span><span class="token-plain" style="opacity:0.3">e</span><span class="token-plain" style="opacity:0.3">r</span><span class="token-plain" style="opacity:0.3">y</span><span class="token-plain" style="opacity:0.3">F</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">A</span><span class="token-punctuation" style="opacity:0.3">]</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain" style="opacity:0.3">​</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-of03ro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-1mpkuhi" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-keyword">c</span><span class="token-keyword">a</span><span class="token-keyword">s</span><span class="token-keyword">e</span><span class="token-plain"> </span><span class="token-keyword">c</span><span class="token-keyword">l</span><span class="token-keyword">a</span><span class="token-keyword">s</span><span class="token-keyword">s</span><span class="token-plain"> </span><span class="token-plain">I</span><span class="token-plain">n</span><span class="token-plain">t</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">s</span><span class="token-plain">e</span><span class="token-plain">c</span><span class="token-plain">t</span><span class="token-plain">s</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">e</span><span class="token-plain">x</span><span class="token-plain">t</span><span class="token-plain">e</span><span class="token-plain">n</span><span class="token-plain">t</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">E</span><span class="token-plain">x</span><span class="token-plain">t</span><span class="token-plain">e</span><span class="token-plain">n</span><span class="token-plain">t</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">e</span><span class="token-keyword">x</span><span class="token-keyword">t</span><span class="token-keyword">e</span><span class="token-keyword">n</span><span class="token-keyword">d</span><span class="token-keyword">s</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span></div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">​</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-21"><span class="token-keyword">v</span><span class="token-keyword">a</span><span class="token-keyword">l</span><span class="token-plain"> </span><span class="token-plain">q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">3</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">_</span><span class="token-plain"> </span><span class="token-operator">&lt;</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">_</span><span class="token-plain"> </span><span class="token-operator">&lt;</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-builtin">N</span><span class="token-builtin">o</span><span class="token-builtin">t</span><span class="token-builtin">h</span><span class="token-builtin">i</span><span class="token-builtin">n</span><span class="token-builtin">g</span><span class="token-punctuation">]</span><span class="token-punctuation">]</span><span class="token-punctuation">]</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-of03ro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-1mpkuhi" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-21"><span class="token-keyword">v</span><span class="token-keyword">a</span><span class="token-keyword">l</span><span class="token-plain"> </span><span class="token-plain">q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">3</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">_</span><span class="token-plain"> </span><span class="token-operator">&lt;</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">_</span><span class="token-plain"> </span><span class="token-operator">&lt;</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">Q</span><span class="token-plain">u</span><span class="token-plain">e</span><span class="token-plain">r</span><span class="token-plain">y</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-builtin">N</span><span class="token-builtin">o</span><span class="token-builtin">t</span><span class="token-builtin">h</span><span class="token-builtin">i</span><span class="token-builtin">n</span><span class="token-builtin">g</span><span class="token-punctuation">]</span><span class="token-punctuation">]</span><span class="token-punctuation">]</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span></div></div><div></div></code></pre></div></div></div></div><h4 class="cs-title css-1xose5o"><span>A minor issue: type of expressions depends on the trees shape</span></h4></div></div><div class="css-k69u56"><div style="width:100vw;max-width:100%;height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center" class="cs-layout"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-plain">Fixed point of a function f is such x, </span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">that f(x) == x == f(f(x)) == ...</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-plain">Bringing that to the type level means </span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-plain">that F[X] == X == F[F[X]]] == ...</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">Fix is a function that computes</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-plain">a fixed point for the input F[_],</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-plain">such as</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-9"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-10"><span class="token-plain">Fix[F] == F[Fix[F]] == F[F[Fix[F]]] == ...</span></div></div><div></div></code></pre><h4 class="cs-title css-1xose5o" style="opacity:1"><span style="opacity:1">Fixing the type using the fixed point</span></h4><p class="cs-subtitle css-fs2d1k" style="opacity:1"><span style="opacity:1">This can be a bit hard to parse</span></p></div></div></div></div></div><div class="css-k69u56"><div style="width:100vw;max-width:100%;height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center" class="cs-layout"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-keyword">c</span><span class="token-keyword">a</span><span class="token-keyword">s</span><span class="token-keyword">e</span><span class="token-plain"> </span><span class="token-keyword">c</span><span class="token-keyword">l</span><span class="token-keyword">a</span><span class="token-keyword">s</span><span class="token-keyword">s</span><span class="token-plain"> </span><span class="token-plain">F</span><span class="token-plain">i</span><span class="token-plain">x</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">_</span><span class="token-punctuation">]</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">u</span><span class="token-plain">n</span><span class="token-plain">f</span><span class="token-plain">i</span><span class="token-plain">x</span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-plain">i</span><span class="token-plain">x</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">]</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div></div></code></pre><p class="cs-subtitle css-fs2d1k"><span style="opacity:1">Not better</span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-keyword" style="opacity:0.3">c</span><span class="token-keyword" style="opacity:0.3">a</span><span class="token-keyword" style="opacity:0.3">s</span><span class="token-keyword" style="opacity:0.3">e</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-keyword" style="opacity:0.3">c</span><span class="token-keyword" style="opacity:0.3">l</span><span class="token-keyword" style="opacity:0.3">a</span><span class="token-keyword" style="opacity:0.3">s</span><span class="token-keyword" style="opacity:0.3">s</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">F</span><span class="token-plain" style="opacity:0.3">i</span><span class="token-plain" style="opacity:0.3">x</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">F</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">_</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">(</span><span class="token-plain" style="opacity:0.3">u</span><span class="token-plain" style="opacity:0.3">n</span><span class="token-plain" style="opacity:0.3">f</span><span class="token-plain" style="opacity:0.3">i</span><span class="token-plain" style="opacity:0.3">x</span><span class="token-operator" style="opacity:0.3">:</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">F</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">F</span><span class="token-plain" style="opacity:0.3">i</span><span class="token-plain" style="opacity:0.3">x</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">F</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">)</span></div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div></div></code></pre><p class="cs-subtitle css-fs2d1k" style="opacity:1"><span style="opacity:1">That is what it actually means</span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-keyword" style="opacity:0.3">c</span><span class="token-keyword" style="opacity:0.3">a</span><span class="token-keyword" style="opacity:0.3">s</span><span class="token-keyword" style="opacity:0.3">e</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-keyword" style="opacity:0.3">c</span><span class="token-keyword" style="opacity:0.3">l</span><span class="token-keyword" style="opacity:0.3">a</span><span class="token-keyword" style="opacity:0.3">s</span><span class="token-keyword" style="opacity:0.3">s</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:1">F</span><span class="token-plain" style="opacity:1">i</span><span class="token-plain" style="opacity:1">x</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">F</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">_</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">(</span><span class="token-plain" style="opacity:0.3">u</span><span class="token-plain" style="opacity:0.3">n</span><span class="token-plain" style="opacity:0.3">f</span><span class="token-plain" style="opacity:0.3">i</span><span class="token-plain" style="opacity:0.3">x</span><span class="token-operator" style="opacity:0.3">:</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">F</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">F</span><span class="token-plain" style="opacity:0.3">i</span><span class="token-plain" style="opacity:0.3">x</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">F</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">)</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div></div></code></pre></div></div></div></div></div><div class="css-k69u56"><div style="width:100vw;max-width:100%;height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center" class="cs-layout"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-punctuation">}</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-12"><span class="token-keyword">def</span><span class="token-plain"> foldRight</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-operator">:</span><span class="token-plain"> Query </span><span class="token-keyword">=&gt;</span><span class="token-plain"> A</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">q</span><span class="token-operator">:</span><span class="token-plain"> Query</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> A </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-13"><span class="token-keyword">def</span><span class="token-plain"> foldRight</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-operator">:</span><span class="token-plain"> QueryF</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-keyword">=&gt;</span><span class="token-plain"> A</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">q</span><span class="token-operator">:</span><span class="token-plain"> QueryF</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> A </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div></div></code></pre><h4 class="cs-title css-1xose5o"><span>Back to the foldRight</span></h4></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-punctuation">}</span></div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-13"><span class="token-keyword">def</span><span class="token-plain"> foldRight</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-operator">:</span><span class="token-plain"> QueryF</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-keyword">=&gt;</span><span class="token-plain"> A</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">q</span><span class="token-operator">:</span><span class="token-plain"> QueryF</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> A </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div></div></code></pre><h4 class="cs-title css-1xose5o"><span>Back to the foldRight</span></h4></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-punctuation">}</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-13"><span class="token-keyword">def</span><span class="token-plain"> foldRight</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-operator">:</span><span class="token-plain"> QueryF</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-keyword">=&gt;</span><span class="token-plain"> A</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">q</span><span class="token-operator">:</span><span class="token-plain"> QueryF</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> A </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-14"><span class="token-keyword" style="opacity:0">d</span><span class="token-keyword" style="opacity:0">e</span><span class="token-keyword" style="opacity:0">f</span><span class="token-plain" style="opacity:0"> </span><span class="token-plain" style="opacity:0">f</span><span class="token-plain" style="opacity:0">o</span><span class="token-plain" style="opacity:0">l</span><span class="token-plain" style="opacity:0">d</span><span class="token-plain" style="opacity:0">R</span><span class="token-plain" style="opacity:0">i</span><span class="token-plain" style="opacity:0">g</span><span class="token-plain" style="opacity:0">h</span><span class="token-plain" style="opacity:0">t</span><span class="token-punctuation" style="opacity:0">[</span><span class="token-plain" style="opacity:0">F</span><span class="token-punctuation" style="opacity:0">[</span><span class="token-plain" style="opacity:0">_</span><span class="token-punctuation" style="opacity:0">]</span><span class="token-punctuation" style="opacity:0">,</span><span class="token-plain" style="opacity:0"> </span><span class="token-plain" style="opacity:0">A</span><span class="token-punctuation" style="opacity:0">]</span><span class="token-punctuation" style="opacity:0">(</span><span class="token-plain" style="opacity:0">f</span><span class="token-operator" style="opacity:0">:</span><span class="token-plain" style="opacity:0"> </span><span class="token-plain" style="opacity:0">F</span><span class="token-punctuation" style="opacity:0">[</span><span class="token-plain" style="opacity:0">A</span><span class="token-punctuation" style="opacity:0">]</span><span class="token-plain" style="opacity:0"> </span><span class="token-keyword" style="opacity:0">=</span><span class="token-keyword" style="opacity:0">&gt;</span><span class="token-plain" style="opacity:0"> </span><span class="token-plain" style="opacity:0">A</span><span class="token-punctuation" style="opacity:0">)</span><span class="token-punctuation" style="opacity:0">(</span><span class="token-plain" style="opacity:0">f</span><span class="token-plain" style="opacity:0">i</span><span class="token-plain" style="opacity:0">x</span><span class="token-operator" style="opacity:0">:</span><span class="token-plain" style="opacity:0"> </span><span class="token-plain" style="opacity:0">F</span><span class="token-plain" style="opacity:0">i</span><span class="token-plain" style="opacity:0">x</span><span class="token-punctuation" style="opacity:0">[</span><span class="token-plain" style="opacity:0">F</span><span class="token-punctuation" style="opacity:0">]</span><span class="token-punctuation" style="opacity:0">)</span><span class="token-operator" style="opacity:0">:</span><span class="token-plain" style="opacity:0"> </span><span class="token-plain" style="opacity:0">A</span><span class="token-plain" style="opacity:0"> </span><span class="token-operator" style="opacity:0">=</span><span class="token-plain" style="opacity:0"> </span><span class="token-operator" style="opacity:0">?</span><span class="token-operator" style="opacity:0">?</span><span class="token-operator" style="opacity:0">?</span></div></div><div></div></code></pre><h4 class="cs-title css-1xose5o" style="opacity:1"><span style="opacity:1">Back to the foldRight</span></h4><p class="cs-subtitle css-fs2d1k" style="opacity:0"><span style="opacity:1"></span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-punctuation">}</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-14"><span class="token-keyword" style="opacity:0.3">d</span><span class="token-keyword" style="opacity:0.3">e</span><span class="token-keyword" style="opacity:0.3">f</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">f</span><span class="token-plain" style="opacity:0.3">o</span><span class="token-plain" style="opacity:0.3">l</span><span class="token-plain" style="opacity:0.3">d</span><span class="token-plain" style="opacity:0.3">R</span><span class="token-plain" style="opacity:0.3">i</span><span class="token-plain" style="opacity:0.3">g</span><span class="token-plain" style="opacity:0.3">h</span><span class="token-plain" style="opacity:0.3">t</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">F</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">_</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">,</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">A</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">(</span><span class="token-plain" style="opacity:0.3">f</span><span class="token-operator" style="opacity:0.3">:</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:1">F</span><span class="token-punctuation" style="opacity:1">[</span><span class="token-plain" style="opacity:1">A</span><span class="token-punctuation" style="opacity:1">]</span><span class="token-plain" style="opacity:1"> </span><span class="token-keyword" style="opacity:1">=</span><span class="token-keyword" style="opacity:1">&gt;</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">A</span><span class="token-punctuation" style="opacity:0.3">)</span><span class="token-punctuation" style="opacity:0.3">(</span><span class="token-plain" style="opacity:0.3">f</span><span class="token-plain" style="opacity:0.3">i</span><span class="token-plain" style="opacity:0.3">x</span><span class="token-operator" style="opacity:0.3">:</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">F</span><span class="token-plain" style="opacity:0.3">i</span><span class="token-plain" style="opacity:0.3">x</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">F</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">)</span><span class="token-operator" style="opacity:0.3">:</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">A</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-operator" style="opacity:0.3">=</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-operator" style="opacity:0.3">?</span><span class="token-operator" style="opacity:0.3">?</span><span class="token-operator" style="opacity:0.3">?</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-19"><span class="token-keyword" style="opacity:0">def</span><span class="token-plain" style="opacity:0"> foldRight</span><span class="token-punctuation" style="opacity:0">[</span><span class="token-plain" style="opacity:0">F</span><span class="token-punctuation" style="opacity:0">[</span><span class="token-plain" style="opacity:0">_</span><span class="token-punctuation" style="opacity:0">]</span><span class="token-punctuation" style="opacity:0">,</span><span class="token-plain" style="opacity:0"> A</span><span class="token-punctuation" style="opacity:0">]</span><span class="token-punctuation" style="opacity:0">(</span><span class="token-plain" style="opacity:0">algebra</span><span class="token-operator" style="opacity:0">:</span><span class="token-plain" style="opacity:0"> Algebra</span><span class="token-punctuation" style="opacity:0">[</span><span class="token-plain" style="opacity:0">F</span><span class="token-punctuation" style="opacity:0">,</span><span class="token-plain" style="opacity:0"> A</span><span class="token-punctuation" style="opacity:0">]</span><span class="token-punctuation" style="opacity:0">)</span><span class="token-punctuation" style="opacity:0">(</span><span class="token-plain" style="opacity:0">fix</span><span class="token-operator" style="opacity:0">:</span><span class="token-plain" style="opacity:0"> Fix</span><span class="token-punctuation" style="opacity:0">[</span><span class="token-plain" style="opacity:0">F</span><span class="token-punctuation" style="opacity:0">]</span><span class="token-punctuation" style="opacity:0">)</span><span class="token-operator" style="opacity:0">:</span><span class="token-plain" style="opacity:0"> A </span><span class="token-operator" style="opacity:0">=</span><span class="token-plain" style="opacity:0"> </span><span class="token-operator" style="opacity:0">?</span><span class="token-operator" style="opacity:0">?</span><span class="token-operator" style="opacity:0">?</span></div></div><div></div></code></pre><p class="cs-subtitle css-fs2d1k" style="opacity:1"><span style="opacity:1">F[A] =&gt; A is called Algebra</span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-punctuation">}</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-19"><span class="token-keyword" style="opacity:0.3">def</span><span class="token-plain" style="opacity:0.3"> foldRight</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">F</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">_</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">,</span><span class="token-plain" style="opacity:0.3"> A</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">(</span><span class="token-plain" style="opacity:0.3">algebra</span><span class="token-operator" style="opacity:0.3">:</span><span class="token-plain" style="opacity:0.3"> Algebra</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">F</span><span class="token-punctuation" style="opacity:0.3">,</span><span class="token-plain" style="opacity:0.3"> A</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">)</span><span class="token-punctuation" style="opacity:0.3">(</span><span class="token-plain" style="opacity:0.3">fix</span><span class="token-operator" style="opacity:0.3">:</span><span class="token-plain" style="opacity:0.3"> Fix</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">F</span><span class="token-punctuation" style="opacity:1">]</span><span class="token-punctuation" style="opacity:1">)</span><span class="token-operator" style="opacity:1">:</span><span class="token-plain" style="opacity:1"> A </span><span class="token-operator" style="opacity:1">=</span><span class="token-plain" style="opacity:1"> </span><span class="token-operator" style="opacity:1">?</span><span class="token-operator" style="opacity:1">?</span><span class="token-operator" style="opacity:1">?</span></div></div><div></div></code></pre><p class="cs-subtitle css-fs2d1k" style="opacity:0"><span style="opacity:1"></span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-punctuation" style="opacity:1">}</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-18"><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain">a</span><span class="token-plain">l</span><span class="token-plain">g</span><span class="token-plain">e</span><span class="token-plain">b</span><span class="token-plain">r</span><span class="token-plain">a</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-plain">i</span><span class="token-plain">x</span><span class="token-punctuation">.</span><span class="token-plain">m</span><span class="token-plain">a</span><span class="token-plain">p</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-plain">a</span><span class="token-plain"> </span><span class="token-keyword">=</span><span class="token-keyword">&gt;</span><span class="token-plain"> </span><span class="token-plain">c</span><span class="token-plain">a</span><span class="token-plain">t</span><span class="token-plain">a</span><span class="token-punctuation">(</span><span class="token-plain">a</span><span class="token-plain">l</span><span class="token-plain">g</span><span class="token-plain">e</span><span class="token-plain">b</span><span class="token-plain">r</span><span class="token-plain">a</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-plain">a</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-comment">/</span><span class="token-comment">/</span><span class="token-comment"> </span><span class="token-comment">i</span><span class="token-comment">t</span><span class="token-comment"> </span><span class="token-comment">d</span><span class="token-comment">o</span><span class="token-comment">e</span><span class="token-comment">s</span><span class="token-comment">n</span><span class="token-comment">&#x27;</span><span class="token-comment">t</span><span class="token-comment"> </span><span class="token-comment">c</span><span class="token-comment">o</span><span class="token-comment">m</span><span class="token-comment">p</span><span class="token-comment">i</span><span class="token-comment">l</span><span class="token-comment">e</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-19"><span class="token-keyword">def</span><span class="token-plain"> foldRight</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">_</span><span class="token-punctuation">]</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">algebra</span><span class="token-operator">:</span><span class="token-plain"> Algebra</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">fix</span><span class="token-operator">:</span><span class="token-plain"> Fix</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> A </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div></div></code></pre><p class="cs-subtitle css-fs2d1k"><span style="opacity:1">foldRight is called catamorphism</span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-punctuation" style="opacity:0.3">}</span></div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-18"><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain">a</span><span class="token-plain">l</span><span class="token-plain">g</span><span class="token-plain">e</span><span class="token-plain">b</span><span class="token-plain">r</span><span class="token-plain">a</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-plain">i</span><span class="token-plain">x</span><span class="token-punctuation">.</span><span class="token-plain">m</span><span class="token-plain">a</span><span class="token-plain">p</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-plain">a</span><span class="token-plain"> </span><span class="token-keyword">=</span><span class="token-keyword">&gt;</span><span class="token-plain"> </span><span class="token-plain">c</span><span class="token-plain">a</span><span class="token-plain">t</span><span class="token-plain">a</span><span class="token-punctuation">(</span><span class="token-plain">a</span><span class="token-plain">l</span><span class="token-plain">g</span><span class="token-plain">e</span><span class="token-plain">b</span><span class="token-plain">r</span><span class="token-plain">a</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-plain">a</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-comment">/</span><span class="token-comment">/</span><span class="token-comment"> </span><span class="token-comment">i</span><span class="token-comment">t</span><span class="token-comment"> </span><span class="token-comment">d</span><span class="token-comment">o</span><span class="token-comment">e</span><span class="token-comment">s</span><span class="token-comment">n</span><span class="token-comment">&#x27;</span><span class="token-comment">t</span><span class="token-comment"> </span><span class="token-comment">c</span><span class="token-comment">o</span><span class="token-comment">m</span><span class="token-comment">p</span><span class="token-comment">i</span><span class="token-comment">l</span><span class="token-comment">e</span></div></div><div></div></code></pre><p class="cs-subtitle css-fs2d1k"><span style="opacity:1">We&#x27;d like to walk the tree to apply the fold function to each node</span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-punctuation" style="opacity:0.3">}</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-16"><span class="token-keyword">def</span><span class="token-plain"> cata</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">_</span><span class="token-punctuation">]</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">algebra</span><span class="token-operator">:</span><span class="token-plain"> Algebra</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">fix</span><span class="token-operator">:</span><span class="token-plain"> Fix</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> A </span><span class="token-operator">=</span><span class="token-plain"> </span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-18"><span class="token-plain"> </span><span class="token-plain"> </span><span class="token-plain">a</span><span class="token-plain">l</span><span class="token-plain">g</span><span class="token-plain">e</span><span class="token-plain">b</span><span class="token-plain">r</span><span class="token-plain">a</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-plain">i</span><span class="token-plain">x</span><span class="token-punctuation">.</span><span class="token-plain">m</span><span class="token-plain">a</span><span class="token-plain">p</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-plain">a</span><span class="token-plain"> </span><span class="token-keyword">=</span><span class="token-keyword">&gt;</span><span class="token-plain"> </span><span class="token-plain">c</span><span class="token-plain">a</span><span class="token-plain">t</span><span class="token-plain">a</span><span class="token-punctuation">(</span><span class="token-plain">a</span><span class="token-plain">l</span><span class="token-plain">g</span><span class="token-plain">e</span><span class="token-plain">b</span><span class="token-plain">r</span><span class="token-plain">a</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-plain">a</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-comment">/</span><span class="token-comment">/</span><span class="token-comment"> </span><span class="token-comment">i</span><span class="token-comment">t</span><span class="token-comment"> </span><span class="token-comment">d</span><span class="token-comment">o</span><span class="token-comment">e</span><span class="token-comment">s</span><span class="token-comment">n</span><span class="token-comment">&#x27;</span><span class="token-comment">t</span><span class="token-comment"> </span><span class="token-comment">c</span><span class="token-comment">o</span><span class="token-comment">m</span><span class="token-comment">p</span><span class="token-comment">i</span><span class="token-comment">l</span><span class="token-comment">e</span></div></div><div></div></code></pre><p class="cs-subtitle css-fs2d1k" style="opacity:1"><span style="opacity:1">Fix[F] != F[Fix[F]]?</span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-punctuation">}</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-10"><span class="token-keyword">def</span><span class="token-plain"> cata</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">_</span><span class="token-punctuation">]</span><span class="token-operator">:</span><span class="token-plain"> Functor</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">algebra</span><span class="token-operator">:</span><span class="token-plain"> Algebra</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">fix</span><span class="token-operator">:</span><span class="token-plain"> Fix</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> A </span><span class="token-operator">=</span><span class="token-plain"> </span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-16"><span class="token-keyword">def</span><span class="token-plain"> cata</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">_</span><span class="token-punctuation">]</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">algebra</span><span class="token-operator">:</span><span class="token-plain"> Algebra</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">fix</span><span class="token-operator">:</span><span class="token-plain"> Fix</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> A </span><span class="token-operator">=</span><span class="token-plain"> </span></div></div><div></div></code></pre><p class="cs-subtitle css-fs2d1k" style="opacity:0"><span style="opacity:1"></span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-punctuation">}</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-10"><span class="token-keyword">def</span><span class="token-plain"> cata</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">_</span><span class="token-punctuation">]</span><span class="token-operator">:</span><span class="token-plain"> Functor</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">algebra</span><span class="token-operator">:</span><span class="token-plain"> Algebra</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">fix</span><span class="token-operator">:</span><span class="token-plain"> Fix</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> A </span><span class="token-operator">=</span><span class="token-plain"> </span></div></div><div></div></code></pre><p class="cs-subtitle css-fs2d1k" style="opacity:1"><span style="opacity:1">The Functor instance defined for the QueryF</span></p></div></div></div></div></div><div class="css-k69u56"><div style="width:100vw;max-width:100%;height:100vh;display:flex;flex-direction:row;justify-content:center;align-items:center;font-size:0.8em;position:relative" class="cs-col-layout"><div style="flex:1;overflow:hidden;height:100%"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-keyword">def</span><span class="token-plain"> evalString</span><span class="token-punctuation">(</span><span class="token-plain">q</span><span class="token-operator">:</span><span class="token-plain"> Query</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> q </span><span class="token-keyword">match</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> And</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">,</span><span class="token-plain"> q2</span><span class="token-punctuation">)</span><span class="token-plain">   </span><span class="token-keyword">=&gt;</span><span class="token-plain"> s</span><span class="token-string">&quot;(${evalString(q1)} and ${evalString(q2)})&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> Or</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">,</span><span class="token-plain"> q2</span><span class="token-punctuation">)</span><span class="token-plain">    </span><span class="token-keyword">=&gt;</span><span class="token-plain"> s</span><span class="token-string">&quot;(${evalString(q1)} or ${evalString(q2)})&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> Intersects</span><span class="token-punctuation">(</span><span class="token-plain">e</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">=&gt;</span><span class="token-plain"> s</span><span class="token-string">&quot;(intersects $e)&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> All</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">         </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span><span class="token-string">&quot;(all)&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> Empty</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">       </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span><span class="token-string">&quot;(empty)&quot;</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-punctuation">}</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-keyword">def</span><span class="token-plain"> evalList</span><span class="token-punctuation">(</span><span class="token-plain">q</span><span class="token-operator">:</span><span class="token-plain"> Query</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> q </span><span class="token-keyword">match</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-9"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> And</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">,</span><span class="token-plain"> q2</span><span class="token-punctuation">)</span><span class="token-plain">   </span><span class="token-keyword">=&gt;</span><span class="token-plain"> list </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-10"><span class="token-plain">                        </span><span class="token-keyword">val</span><span class="token-plain"> left </span><span class="token-operator">=</span><span class="token-plain"> evalList</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">list</span><span class="token-punctuation">)</span><span class="token-plain"> </span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-11"><span class="token-plain">                        evalList</span><span class="token-punctuation">(</span><span class="token-plain">q2</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">left</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-12"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> Or</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">,</span><span class="token-plain"> q2</span><span class="token-punctuation">)</span><span class="token-plain">    </span><span class="token-keyword">=&gt;</span><span class="token-plain"> list </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-13"><span class="token-plain">                        evalList</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">list</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">++</span><span class="token-plain"> evalList</span><span class="token-punctuation">(</span><span class="token-plain">q2</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">list</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-14"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> Intersects</span><span class="token-punctuation">(</span><span class="token-plain">e</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">=&gt;</span><span class="token-plain"> _</span><span class="token-punctuation">.</span><span class="token-plain">filter</span><span class="token-punctuation">(</span><span class="token-plain">_</span><span class="token-punctuation">.</span><span class="token-plain">extent</span><span class="token-punctuation">.</span><span class="token-plain">intersects</span><span class="token-punctuation">(</span><span class="token-plain">e</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-15"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> All</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">         </span><span class="token-keyword">=&gt;</span><span class="token-plain"> identity</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-16"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> Empty</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">       </span><span class="token-keyword">=&gt;</span><span class="token-plain"> _ </span><span class="token-keyword">=&gt;</span><span class="token-plain"> Nil</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-17"><span class="token-punctuation">}</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> And</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">,</span><span class="token-plain"> q2</span><span class="token-punctuation">)</span><span class="token-plain">   </span><span class="token-keyword">=&gt;</span><span class="token-plain"> s</span><span class="token-string">&quot;(${evalString(q1)} and ${evalString(q2)})&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-punctuation">}</span></div></div><div></div></code></pre></div></div></div></div><div style="flex:1;overflow:hidden;height:100%"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-of03ro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-1mpkuhi" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-keyword">val</span><span class="token-plain"> algebraString</span><span class="token-operator">:</span><span class="token-plain"> Algebra</span><span class="token-punctuation">[</span><span class="token-plain">QueryF</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-builtin">String</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> And</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">,</span><span class="token-plain"> q2</span><span class="token-punctuation">)</span><span class="token-plain">   </span><span class="token-keyword">=&gt;</span><span class="token-plain"> s</span><span class="token-string">&quot;($q1 and $q2)&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> Or</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">,</span><span class="token-plain"> q2</span><span class="token-punctuation">)</span><span class="token-plain">    </span><span class="token-keyword">=&gt;</span><span class="token-plain"> s</span><span class="token-string">&quot;($q1 or $q2)&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> Intersects</span><span class="token-punctuation">(</span><span class="token-plain">e</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">=&gt;</span><span class="token-plain"> s</span><span class="token-string">&quot;(intersects $e)&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> All</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">         </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span><span class="token-string">&quot;(all)&quot;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> Empty</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">       </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span><span class="token-string">&quot;(empty)&quot;</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-punctuation">}</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-9"><span class="token-keyword">val</span><span class="token-plain"> algebraList</span><span class="token-operator">:</span><span class="token-plain"> Algebra</span><span class="token-punctuation">[</span><span class="token-plain">QueryF</span><span class="token-punctuation">,</span><span class="token-plain"> List</span><span class="token-punctuation">[</span><span class="token-plain">Raster</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-keyword">=&gt;</span><span class="token-plain"> List</span><span class="token-punctuation">[</span><span class="token-plain">Raster</span><span class="token-punctuation">]</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-10"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> And</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">,</span><span class="token-plain"> q2</span><span class="token-punctuation">)</span><span class="token-plain">   </span><span class="token-keyword">=&gt;</span><span class="token-plain"> list </span><span class="token-keyword">=&gt;</span><span class="token-plain"> </span><span class="token-keyword">val</span><span class="token-plain"> left </span><span class="token-operator">=</span><span class="token-plain"> q1</span><span class="token-punctuation">(</span><span class="token-plain">list</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span><span class="token-plain"> q2</span><span class="token-punctuation">(</span><span class="token-plain">left</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-11"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> Or</span><span class="token-punctuation">(</span><span class="token-plain">q1</span><span class="token-punctuation">,</span><span class="token-plain"> q2</span><span class="token-punctuation">)</span><span class="token-plain">    </span><span class="token-keyword">=&gt;</span><span class="token-plain"> list </span><span class="token-keyword">=&gt;</span><span class="token-plain"> q1</span><span class="token-punctuation">(</span><span class="token-plain">list</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">++</span><span class="token-plain"> q2</span><span class="token-punctuation">(</span><span class="token-plain">list</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-12"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> Intersects</span><span class="token-punctuation">(</span><span class="token-plain">e</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">=&gt;</span><span class="token-plain"> _</span><span class="token-punctuation">.</span><span class="token-plain">filter</span><span class="token-punctuation">(</span><span class="token-plain">_</span><span class="token-punctuation">.</span><span class="token-plain">extent</span><span class="token-punctuation">.</span><span class="token-plain">intersects</span><span class="token-punctuation">(</span><span class="token-plain">e</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-13"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> All</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">         </span><span class="token-keyword">=&gt;</span><span class="token-plain"> identity</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-14"><span class="token-plain">  </span><span class="token-keyword">case</span><span class="token-plain"> Empty</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain">       </span><span class="token-keyword">=&gt;</span><span class="token-plain"> _ </span><span class="token-keyword">=&gt;</span><span class="token-plain"> Nil</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-15"><span class="token-punctuation">}</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-of03ro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-1mpkuhi" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-punctuation">}</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-9"><span class="token-keyword">val</span><span class="token-plain"> algebraList</span><span class="token-operator">:</span><span class="token-plain"> Algebra</span><span class="token-punctuation">[</span><span class="token-plain">QueryF</span><span class="token-punctuation">,</span><span class="token-plain"> List</span><span class="token-punctuation">[</span><span class="token-plain">Raster</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-keyword">=&gt;</span><span class="token-plain"> List</span><span class="token-punctuation">[</span><span class="token-plain">Raster</span><span class="token-punctuation">]</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div></div></code></pre></div></div></div></div><h4 class="cs-title css-1xose5o"><span>Language Interpretation</span></h4></div></div><div class="css-k69u56"><div style="width:100vw;max-width:100%;height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center" class="cs-layout"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-97"><span class="token-keyword">def</span><span class="token-plain"> foldRight</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">_</span><span class="token-punctuation">]</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-operator">:</span><span class="token-plain"> F</span><span class="token-punctuation">[</span><span class="token-plain">A</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-keyword">=&gt;</span><span class="token-plain"> A</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">fix</span><span class="token-operator">:</span><span class="token-plain"> Fix</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> A </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-98"><span class="token-keyword" style="opacity:1">d</span><span class="token-keyword" style="opacity:1">e</span><span class="token-keyword" style="opacity:1">f</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">u</span><span class="token-plain" style="opacity:1">n</span><span class="token-plain" style="opacity:1">f</span><span class="token-plain" style="opacity:1">o</span><span class="token-plain" style="opacity:1">l</span><span class="token-plain" style="opacity:1">d</span><span class="token-punctuation" style="opacity:1">[</span><span class="token-plain" style="opacity:1">F</span><span class="token-punctuation" style="opacity:1">[</span><span class="token-plain" style="opacity:1">_</span><span class="token-punctuation" style="opacity:1">]</span><span class="token-punctuation" style="opacity:1">,</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">A</span><span class="token-punctuation" style="opacity:1">]</span><span class="token-punctuation" style="opacity:1">(</span><span class="token-plain" style="opacity:1">f</span><span class="token-operator" style="opacity:1">:</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">A</span><span class="token-plain" style="opacity:1"> </span><span class="token-keyword" style="opacity:1">=</span><span class="token-keyword" style="opacity:1">&gt;</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">F</span><span class="token-punctuation" style="opacity:1">[</span><span class="token-plain" style="opacity:1">A</span><span class="token-punctuation" style="opacity:1">]</span><span class="token-punctuation" style="opacity:1">)</span><span class="token-punctuation" style="opacity:1">(</span><span class="token-plain" style="opacity:1">a</span><span class="token-operator" style="opacity:1">:</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">A</span><span class="token-punctuation" style="opacity:1">)</span><span class="token-operator" style="opacity:1">:</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">F</span><span class="token-plain" style="opacity:1">i</span><span class="token-plain" style="opacity:1">x</span><span class="token-punctuation" style="opacity:1">[</span><span class="token-plain" style="opacity:1">F</span><span class="token-punctuation" style="opacity:1">]</span><span class="token-plain" style="opacity:1"> </span><span class="token-operator" style="opacity:1">=</span><span class="token-plain" style="opacity:1"> </span><span class="token-operator" style="opacity:1">?</span><span class="token-operator" style="opacity:1">?</span><span class="token-operator" style="opacity:1">?</span></div></div><div></div></code></pre><h4 class="cs-title css-1xose5o" style="opacity:1"><span style="opacity:1">What about the unfold function?</span></h4><p class="cs-subtitle css-fs2d1k"><span style="opacity:1">When there is a mention of a fold, a question about the unfold may appear</span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-92"><span class="token-keyword">def</span><span class="token-plain"> unfold</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">_</span><span class="token-punctuation">]</span><span class="token-operator">:</span><span class="token-plain"> Functor</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">coalgebra</span><span class="token-operator">:</span><span class="token-plain"> Coalgebra</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">a</span><span class="token-operator">:</span><span class="token-plain"> A</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> Fix</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-98"><span class="token-keyword" style="opacity:0.3">d</span><span class="token-keyword" style="opacity:0.3">e</span><span class="token-keyword" style="opacity:0.3">f</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">u</span><span class="token-plain" style="opacity:0.3">n</span><span class="token-plain" style="opacity:0.3">f</span><span class="token-plain" style="opacity:0.3">o</span><span class="token-plain" style="opacity:0.3">l</span><span class="token-plain" style="opacity:0.3">d</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">F</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">_</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">,</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">A</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-punctuation" style="opacity:0.3">(</span><span class="token-plain" style="opacity:0.3">f</span><span class="token-operator" style="opacity:0.3">:</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:1">A</span><span class="token-plain" style="opacity:1"> </span><span class="token-keyword" style="opacity:1">=</span><span class="token-keyword" style="opacity:1">&gt;</span><span class="token-plain" style="opacity:1"> </span><span class="token-plain" style="opacity:1">F</span><span class="token-punctuation" style="opacity:1">[</span><span class="token-plain" style="opacity:1">A</span><span class="token-punctuation" style="opacity:1">]</span><span class="token-punctuation" style="opacity:0.3">)</span><span class="token-punctuation" style="opacity:0.3">(</span><span class="token-plain" style="opacity:0.3">a</span><span class="token-operator" style="opacity:0.3">:</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">A</span><span class="token-punctuation" style="opacity:0.3">)</span><span class="token-operator" style="opacity:0.3">:</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-plain" style="opacity:0.3">F</span><span class="token-plain" style="opacity:0.3">i</span><span class="token-plain" style="opacity:0.3">x</span><span class="token-punctuation" style="opacity:0.3">[</span><span class="token-plain" style="opacity:0.3">F</span><span class="token-punctuation" style="opacity:0.3">]</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-operator" style="opacity:0.3">=</span><span class="token-plain" style="opacity:0.3"> </span><span class="token-operator" style="opacity:0.3">?</span><span class="token-operator" style="opacity:0.3">?</span><span class="token-operator" style="opacity:0.3">?</span></div></div><div></div></code></pre><p class="cs-subtitle css-fs2d1k"><span>A =&gt; F[A] is called Coalgebra</span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-92"><span class="token-keyword">def</span><span class="token-plain"> unfold</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">_</span><span class="token-punctuation">]</span><span class="token-operator">:</span><span class="token-plain"> Functor</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">coalgebra</span><span class="token-operator">:</span><span class="token-plain"> Coalgebra</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">a</span><span class="token-operator">:</span><span class="token-plain"> A</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> Fix</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span></div></div><div></div></code></pre><p class="cs-subtitle css-fs2d1k"><span style="opacity:1">A =&gt; F[A] is called Coalgebra</span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-67"><span class="token-keyword">val</span><span class="token-plain"> coalgebraJson</span><span class="token-operator">:</span><span class="token-plain"> Coalgebra</span><span class="token-punctuation">[</span><span class="token-plain">QueryF</span><span class="token-punctuation">,</span><span class="token-plain"> Json</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> _</span><span class="token-punctuation">.</span><span class="token-plain">foldWith</span><span class="token-punctuation">(</span><span class="token-keyword">new</span><span class="token-plain"> Json</span><span class="token-punctuation">.</span><span class="token-plain">Folder</span><span class="token-punctuation">[</span><span class="token-plain">QueryF</span><span class="token-punctuation">[</span><span class="token-plain">Json</span><span class="token-punctuation">]</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-92"><span class="token-keyword">def</span><span class="token-plain"> unfold</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">_</span><span class="token-punctuation">]</span><span class="token-operator">:</span><span class="token-plain"> Functor</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">(</span><span class="token-plain">coalgebra</span><span class="token-operator">:</span><span class="token-plain"> Coalgebra</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">a</span><span class="token-operator">:</span><span class="token-plain"> A</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> Fix</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span></div></div><div></div></code></pre><h4 class="cs-title css-1xose5o" style="opacity:0"><span style="opacity:1"></span></h4><p class="cs-subtitle css-fs2d1k"><span style="opacity:1">unfold is called anamorphism</span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-67"><span class="token-keyword">val</span><span class="token-plain"> coalgebraJson</span><span class="token-operator">:</span><span class="token-plain"> Coalgebra</span><span class="token-punctuation">[</span><span class="token-plain">QueryF</span><span class="token-punctuation">,</span><span class="token-plain"> Json</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> _</span><span class="token-punctuation">.</span><span class="token-plain">foldWith</span><span class="token-punctuation">(</span><span class="token-keyword">new</span><span class="token-plain"> Json</span><span class="token-punctuation">.</span><span class="token-plain">Folder</span><span class="token-punctuation">[</span><span class="token-plain">QueryF</span><span class="token-punctuation">[</span><span class="token-plain">Json</span><span class="token-punctuation">]</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-77"><span class="token-keyword">def</span><span class="token-plain"> asJson</span><span class="token-punctuation">(</span><span class="token-plain">query</span><span class="token-operator">:</span><span class="token-plain"> Fix</span><span class="token-punctuation">[</span><span class="token-plain">QueryF</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> Json  </span><span class="token-operator">=</span><span class="token-plain"> cata</span><span class="token-punctuation">(</span><span class="token-plain">algebraJson</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">query</span><span class="token-punctuation">)</span></div></div><div></div></code></pre><h4 class="cs-title css-1xose5o"><span>A Coalgebra example</span></h4><p class="cs-subtitle css-fs2d1k"><span>to build a QueryF expression from a given JSON tree</span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-21"><span class="token-plain">                                    </span><span class="token-string">&quot;xmin&quot;</span><span class="token-plain"> </span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-operator">-</span><span class="token-number">116.9</span><span class="token-punctuation">,</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-77"><span class="token-keyword">def</span><span class="token-plain"> asJson</span><span class="token-punctuation">(</span><span class="token-plain">query</span><span class="token-operator">:</span><span class="token-plain"> Fix</span><span class="token-punctuation">[</span><span class="token-plain">QueryF</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> Json  </span><span class="token-operator">=</span><span class="token-plain"> cata</span><span class="token-punctuation">(</span><span class="token-plain">algebraJson</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">query</span><span class="token-punctuation">)</span></div></div><div></div></code></pre><h4 class="cs-title css-1xose5o" style="opacity:1"><span style="opacity:1">A Coalgebra example</span></h4><p class="cs-subtitle css-fs2d1k" style="opacity:1"><span style="opacity:1">to build a QueryF expression from a given JSON tree</span></p></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-comment">//       Fix(Intersects(Extent(-116.9, 34.8, -113.8, 36.9))),</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-21"><span class="token-plain">                                    </span><span class="token-string">&quot;xmin&quot;</span><span class="token-plain"> </span><span class="token-operator">:</span><span class="token-plain"> </span><span class="token-operator">-</span><span class="token-number">116.9</span><span class="token-punctuation">,</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-comment">//       Fix(Intersects(Extent(-116.9, 34.8, -113.8, 36.9))),</span></div></div><div></div></code></pre></div></div></div></div></div><div class="css-k69u56"><div style="width:100vw;max-width:100%;height:100vh;display:flex;flex-direction:row;justify-content:center;align-items:center;font-size:0.8em;position:relative" class="cs-col-layout"><div style="flex:1;overflow:hidden;height:100%"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-plain">cata</span><span class="token-punctuation">(</span><span class="token-plain">algebraList</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">query</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-comment">//&gt; List[Raster] =&gt; List[Raster]</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-keyword">val</span><span class="token-plain"> coalgebraJson</span><span class="token-operator">:</span><span class="token-plain"> Coalgebra</span><span class="token-punctuation">[</span><span class="token-plain">QueryF</span><span class="token-punctuation">,</span><span class="token-plain"> Json</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-keyword">val</span><span class="token-plain"> algebraList</span><span class="token-operator">:</span><span class="token-plain"> Algebra</span><span class="token-punctuation">[</span><span class="token-plain">QueryF</span><span class="token-punctuation">,</span><span class="token-plain"> List</span><span class="token-punctuation">[</span><span class="token-plain">Raster</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-keyword">=&gt;</span><span class="token-plain"> List</span><span class="token-punctuation">[</span><span class="token-plain">Raster</span><span class="token-punctuation">]</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-operator">?</span><span class="token-operator">?</span><span class="token-operator">?</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-keyword">val</span><span class="token-plain"> query </span><span class="token-operator">=</span><span class="token-plain"> ana</span><span class="token-punctuation">(</span><span class="token-plain">coalgebraJson</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">json</span><span class="token-operator">:</span><span class="token-plain"> Json</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-comment">// Fix(Or(</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-comment">//   Fix(And(</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-comment">//     Fix(And(</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-comment">//       Fix(Intersects(Extent(-116.9, 34.8, -113.8, 36.9))),</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-9"><span class="token-comment">//       Fix(Intersects(Extent(-115.5, 33.2, -111.7, 35.6)))</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-10"><span class="token-comment">//     )),</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-11"><span class="token-comment">//     Fix(Intersects(Extent(-115.5, 39.2, -110.9, 42.5)))</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-12"><span class="token-comment">//   )),</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-13"><span class="token-comment">//   Fix(Intersects(Extent(-107.6, 38.5, -102.6, 42.1)))</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-14"><span class="token-comment">// ))</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-15"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-16"><span class="token-comment">//&gt; List[Raster] =&gt; List[Raster]</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-18"><span class="token-plain">cata</span><span class="token-punctuation">(</span><span class="token-plain">algebraList</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">query</span><span class="token-punctuation">)</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-14tzmro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-xdak34" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-plain">cata</span><span class="token-punctuation">(</span><span class="token-plain">algebraList</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">query</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-comment">//&gt; List[Raster] =&gt; List[Raster]</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-plain">​</span></div></div><div></div></code></pre></div></div></div></div><div style="flex:1;overflow:hidden;height:100%"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-of03ro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-1mpkuhi" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-keyword">def</span><span class="token-plain"> hylo</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">[</span><span class="token-plain">_</span><span class="token-punctuation">]</span><span class="token-operator">:</span><span class="token-plain"> Functor</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">,</span><span class="token-plain"> B</span><span class="token-punctuation">]</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">  </span><span class="token-punctuation">(</span><span class="token-plain">algebra</span><span class="token-operator">:</span><span class="token-plain"> Algebra</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">,</span><span class="token-plain"> B</span><span class="token-punctuation">]</span><span class="token-punctuation">,</span><span class="token-plain"> coalgebra</span><span class="token-operator">:</span><span class="token-plain"> Coalgebra</span><span class="token-punctuation">[</span><span class="token-plain">F</span><span class="token-punctuation">,</span><span class="token-plain"> A</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-plain">  </span><span class="token-punctuation">(</span><span class="token-plain">a</span><span class="token-operator">:</span><span class="token-plain"> A</span><span class="token-punctuation">)</span><span class="token-operator">:</span><span class="token-plain"> B </span><span class="token-operator">=</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-plain">    algebra</span><span class="token-punctuation">(</span><span class="token-plain">coalgebra</span><span class="token-punctuation">(</span><span class="token-plain">a</span><span class="token-punctuation">)</span><span class="token-punctuation">.</span><span class="token-plain">map</span><span class="token-punctuation">(</span><span class="token-plain">hylo</span><span class="token-punctuation">(</span><span class="token-plain">a </span><span class="token-keyword">=&gt;</span><span class="token-plain"> algebra</span><span class="token-punctuation">,</span><span class="token-plain"> coalgebra</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">a</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-comment">//&gt; List[Raster] =&gt; List[Raster]</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">hylo</span><span class="token-punctuation">(</span><span class="token-plain">algebraList</span><span class="token-punctuation">,</span><span class="token-plain"> coalgebraJson</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">json</span><span class="token-operator">:</span><span class="token-plain"> Json</span><span class="token-punctuation">)</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-of03ro" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-1mpkuhi" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-plain">    algebra</span><span class="token-punctuation">(</span><span class="token-plain">coalgebra</span><span class="token-punctuation">(</span><span class="token-plain">a</span><span class="token-punctuation">)</span><span class="token-punctuation">.</span><span class="token-plain">map</span><span class="token-punctuation">(</span><span class="token-plain">hylo</span><span class="token-punctuation">(</span><span class="token-plain">a </span><span class="token-keyword">=&gt;</span><span class="token-plain"> algebra</span><span class="token-punctuation">,</span><span class="token-plain"> coalgebra</span><span class="token-punctuation">)</span><span class="token-punctuation">(</span><span class="token-plain">a</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-plain">​</span></div></div><div></div></code></pre></div></div></div></div><h4 class="cs-title css-1xose5o"><span>Compose cata and ana!</span></h4><p class="cs-subtitle css-fs2d1k" style="margin:0.3em 0"><span>In a single step</span></p></div></div><div class="css-k69u56"><h3 class="css-1djqpdg">Benefits?</h3></div><div class="css-k69u56"><img src="https://github.com/precog/matryoshka/raw/master/resources/recursion-schemes.png" class="css-wnzno2"/></div><div class="css-k69u56"><h3 class="css-1djqpdg">Problems</h3><ul class="css-1uk1gs8"><li class="css-0">The barrier to entry</li><li class="css-0">Fix type in all expression signatures</li></ul></div><div class="css-k69u56"><h3 class="css-1djqpdg">Summary</h3><ul class="css-1uk1gs8"><li class="css-0">Recursion schemes are generalized functions to traverse through nested structures</li><li class="css-0">It is not a mystery, it is a powerfull tool that helps to work with nested data structures</li><li class="css-0">There is more than a single way to traverse over the nested structure</li><li class="css-0">The barrier to entry is pretty high (unknown words and unknown types can be a problem)</li></ul></div><div class="css-k69u56"><h4 class="css-1djqpdg">Links:</h4><ul class="css-1uk1gs8"><li class="css-0"><a href="https://github.com/pomadchin/path-to-recschemes" class="css-6y53u">https://github.com/pomadchin/path-to-recschemes</a></li><li class="css-0"><a href="https://github.com/higherkindness/droste" class="css-6y53u">https://github.com/higherkindness/droste</a></li><li class="css-0"><a href="https://www.47deg.com/blog/recursion-schemes-introduction" class="css-6y53u">https://www.47deg.com/blog/recursion-schemes-introduction</a></li><li class="css-0">GitHub: @pomadchin </li><li class="css-0">Twitter: @daunnc</li><li class="css-0">Email: gr.pomadchin <!-- -->[at]<!-- --> gmail.com</li></ul><h4 class="css-1djqpdg">Thanks!</h4></div></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/print";window.webpackCompilationHash="80f287469f6ec8c3a5be";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-298faa2e9defffbeb4c3.js"],"component---gatsby-theme-mdx-deck-src-templates-deck-js":["/component---gatsby-theme-mdx-deck-src-templates-deck-js-2c92febbeb618bbc1a78.js"]};/*]]>*/</script><script src="/webpack-runtime-cbe9baa0c15c82eadd81.js" async=""></script><script src="/app-298faa2e9defffbeb4c3.js" async=""></script><script src="/commons-e097865efcb51aa1e34c.js" async=""></script><script src="/component---gatsby-theme-mdx-deck-src-templates-deck-js-2c92febbeb618bbc1a78.js" async=""></script></body></html>